(()=>{"use strict";var e,r,t={1399:(e,r,t)=>{var i=t(842),n=t(9884),o=t(5134),s=function(e,r,t,i){return new(t||(t=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(s,a)}c((i=i.apply(e,r||[])).next())}))};let a;const c={},l=new i.Z({max:32});let d,u=1;const f={xOpen:function(e){return s(this,void 0,void 0,(function*(){let r=l.get(e.url);return r instanceof Promise&&(r=yield r),void 0!==r||(r=fetch(e.url,{method:"HEAD",headers:Object.assign({},null==a?void 0:a.headers)}).then((r=>{var t;return"bytes"!==r.headers.get("Accept-Ranges")&&console.warn(`Server for ${e.url} does not advertise 'Accept-Ranges'. If the server supports it, in order to remove this message, add "Accept-Ranges: bytes". Additionally, if using CORS, add "Access-Control-Expose-Headers: *".`),{url:e.url,id:u++,size:BigInt(null!==(t=r.headers.get("Content-Length"))&&void 0!==t?t:0),pageSize:null}})),l.set(e.url,r),l.set(e.url,yield r)),0}))},xAccess:function(e,r){return s(this,void 0,void 0,(function*(){const t=new Uint32Array(r.shm,0,1);try{const i=yield f.xOpen(e,r);t[0]=0===i?1:0}catch(e){t[0]=0}return 0}))},xRead:function(e,r){var t,i,c;return s(this,void 0,void 0,(function*(){let s=l.get(e.url);if(!s)throw new Error(`File ${e.url} not open`);if(s instanceof Promise&&(s=yield s),void 0===e.n||void 0===e.offset)throw new Error("Mandatory arguments missing");if(!s.pageSize){s.pageSize=1024;const r=new ArrayBuffer(2),c=yield f.xRead({msg:"xRead",url:e.url,offset:BigInt(16),n:2},{buffer:new Uint8Array(r)}),l=new Uint16Array(r);if(0!==c)return c;if((0,o.g)(l),s.pageSize=l[0],n.fF.vfs(`page size is ${s.pageSize}`),1024!=s.pageSize&&(console.warn(`Page size for ${e.url} is ${s.pageSize}, recommended size is 1024`),d.delete(s.id+"|0")),s.pageSize>(null!==(t=null==a?void 0:a.maxPageSize)&&void 0!==t?t:n.vC.maxPageSize))throw new Error(`${s.pageSize} is over the maximum configured ${null!==(i=null==a?void 0:a.maxPageSize)&&void 0!==i?i:n.vC.maxPageSize}`)}const u=BigInt(s.pageSize),g=BigInt(e.n),h=e.offset/u;h*u!==e.offset&&n.fF.vfs(`Read chunk ${e.offset}:${e.n} is not page-aligned`);let p=h*u;if(p+u<e.offset+g)throw new Error(`Read chunk ${e.offset}:${e.n} spans across a page-boundary`);const v=s.id+"|"+h;let m=d.get(v);if(m instanceof Promise&&(m=yield m),"number"==typeof m){n.fF.cache(`cache hit (multi-page segment) for ${e.url}:${h}`);const r=BigInt(m)*u;m=d.get(s.id+"|"+m),m instanceof Promise&&(m=yield m),m instanceof Uint8Array?p=r:m=void 0}if(void 0===m){n.fF.cache(`cache miss for ${e.url}:${h}`);let r=s.pageSize,t=h>0&&d.get(s.id+"|"+(Number(h)-1));t&&(t instanceof Promise&&(t=yield t),"number"==typeof t&&(t=d.get(s.id+"|"+t)),t instanceof Promise&&(t=yield t),t instanceof Uint8Array&&(r=2*t.byteLength,n.fF.cache(`downloading super page of size ${r}`)));const i=r/s.pageSize;n.fF.http(`downloading page ${h} of size ${r} starting at ${p}`);const o=fetch(e.url,{method:"GET",headers:Object.assign(Object.assign({},null!==(c=null==a?void 0:a.headers)&&void 0!==c?c:n.vC.headers),{Range:`bytes=${p}-${p+BigInt(r-1)}`})}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e)));d.set(v,o);for(let e=Number(h)+1;e<Number(h)+i;e++)d.set(s.id+"|"+e,o.then((()=>Number(h))));if(m=yield o,!(m instanceof Uint8Array)||0===m.length)throw new Error(`Invalid HTTP response received: ${JSON.stringify(o)}`);d.set(v,m);for(let e=Number(h)+1;e<Number(h)+i;e++)d.set(s.id+"|"+e,Number(h))}else n.fF.cache(`cache hit for ${e.url}:${h}`);const y=Number(e.offset-p);return r.buffer.set(m.subarray(y,y+e.n)),0}))},xFilesize:function(e,r){return s(this,void 0,void 0,(function*(){let t=l.get(e.url);if(!t)throw new Error(`File ${e.fid} not open`);return t instanceof Promise&&(t=yield t),new BigInt64Array(r.shm,0,1)[0]=t.size,0}))}};function g({data:e}){return s(this,void 0,void 0,(function*(){let r;n.fF.threads("Received new work message",this,e);try{r=yield f[e.msg](e,this),n.fF.threads("operation successful",this,r),Atomics.store(this.lock,0,r)}catch(e){console.error(e),Atomics.store(this.lock,0,1)}Atomics.notify(this.lock,0)}))}if(globalThis.onmessage=({data:e})=>{var r,t,o,s;switch(n.fF.threads("Received new control message",e),e.msg){case"handshake":{const i=new SharedArrayBuffer((null!==(r=null==a?void 0:a.maxPageSize)&&void 0!==r?r:n.vC.maxPageSize)+Int32Array.BYTES_PER_ELEMENT),s=new Int32Array(i,null!==(t=null==a?void 0:a.maxPageSize)&&void 0!==t?t:n.vC.maxPageSize),l=new Uint8Array(i,0,null!==(o=null==a?void 0:a.maxPageSize)&&void 0!==o?o:n.vC.maxPageSize);s[0]=65535,c[e.id]={id:e.id,port:e.port,shm:i,lock:s,buffer:l},postMessage({msg:"ack",id:e.id,shm:i,lock:s}),e.port.onmessage=g.bind(c[e.id])}break;case"init":a=e.options,d=new i.Z({maxSize:1024*(null!==(s=null==a?void 0:a.cacheSize)&&void 0!==s?s:n.vC.cacheSize),sizeCalculation:e=>{var r;return null!==(r=e.byteLength)&&void 0!==r?r:4}});break;case"close":postMessage({msg:"ack"}),close();break;default:throw new Error(`Invalid message received by backend: ${e}`)}},"undefined"==typeof SharedArrayBuffer)throw new Error('SharedArrayBuffer is not available. If your browser supports it, the webserver must send "Cross-Origin-Opener-Policy: same-origin "and "Cross-Origin-Embedder-Policy: require-corp" headers.')}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.m=t,n.x=()=>{var e=n.O(void 0,[106],(()=>n(1399)));return n.O(e)},e=[],n.O=(r,t,i,o)=>{if(!t){var s=1/0;for(d=0;d<e.length;d++){for(var[t,i,o]=e[d],a=!0,c=0;c<t.length;c++)(!1&o||s>=o)&&Object.keys(n.O).every((e=>n.O[e](t[c])))?t.splice(c--,1):(a=!1,o<s&&(s=o));if(a){e.splice(d--,1);var l=i();void 0!==l&&(r=l)}}return r}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[t,i,o]},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((r,t)=>(n.f[t](e,r),r)),[])),n.u=e=>e+".bundle.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var r=n.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var t=r.getElementsByTagName("script");t.length&&(e=t[t.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={399:1};n.f.i=(r,t)=>{e[r]||importScripts(n.p+n.u(r))};var r=self.webpackChunkol_gpkg=self.webpackChunkol_gpkg||[],t=r.push.bind(r);r.push=r=>{var[i,o,s]=r;for(var a in o)n.o(o,a)&&(n.m[a]=o[a]);for(s&&s(n);i.length;)e[i.pop()]=1;t(r)}})(),r=n.x,n.x=()=>n.e(106).then(r),n.x()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUt0RCxLQUFLbEIsR1VEZHlGLEVBQW9CTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2wtZ3BrZy93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL29sLWdwa2cvd2VicGFjay9ydW50aW1lL3N0YXJ0dXAgY2h1bmsgZGVwZW5kZW5jaWVzIiwid2VicGFjazovL29sLWdwa2cvLi9ub2RlX21vZHVsZXMvc3FsaXRlLXdhc20taHR0cC9zcmMvdmZzLWh0dHAtd29ya2VyLnRzIiwid2VicGFjazovL29sLWdwa2cvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vb2wtZ3BrZy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vb2wtZ3BrZy93ZWJwYWNrL3J1bnRpbWUvZW5zdXJlIGNodW5rIiwid2VicGFjazovL29sLWdwa2cvd2VicGFjay9ydW50aW1lL2dldCBqYXZhc2NyaXB0IGNodW5rIGZpbGVuYW1lIiwid2VicGFjazovL29sLWdwa2cvd2VicGFjay9ydW50aW1lL2dsb2JhbCIsIndlYnBhY2s6Ly9vbC1ncGtnL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vb2wtZ3BrZy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9vbC1ncGtnL3dlYnBhY2svcnVudGltZS9pbXBvcnRTY3JpcHRzIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vb2wtZ3BrZy93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRlZmVycmVkID0gW107XG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8gPSAocmVzdWx0LCBjaHVua0lkcywgZm4sIHByaW9yaXR5KSA9PiB7XG5cdGlmKGNodW5rSWRzKSB7XG5cdFx0cHJpb3JpdHkgPSBwcmlvcml0eSB8fCAwO1xuXHRcdGZvcih2YXIgaSA9IGRlZmVycmVkLmxlbmd0aDsgaSA+IDAgJiYgZGVmZXJyZWRbaSAtIDFdWzJdID4gcHJpb3JpdHk7IGktLSkgZGVmZXJyZWRbaV0gPSBkZWZlcnJlZFtpIC0gMV07XG5cdFx0ZGVmZXJyZWRbaV0gPSBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV07XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhciBub3RGdWxmaWxsZWQgPSBJbmZpbml0eTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZC5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV0gPSBkZWZlcnJlZFtpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGNodW5rSWRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAoKHByaW9yaXR5ICYgMSA9PT0gMCB8fCBub3RGdWxmaWxsZWQgPj0gcHJpb3JpdHkpICYmIE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uTykuZXZlcnkoKGtleSkgPT4gKF9fd2VicGFja19yZXF1aXJlX18uT1trZXldKGNodW5rSWRzW2pdKSkpKSB7XG5cdFx0XHRcdGNodW5rSWRzLnNwbGljZShqLS0sIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0XHRcdGlmKHByaW9yaXR5IDwgbm90RnVsZmlsbGVkKSBub3RGdWxmaWxsZWQgPSBwcmlvcml0eTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoZnVsZmlsbGVkKSB7XG5cdFx0XHRkZWZlcnJlZC5zcGxpY2UoaS0tLCAxKVxuXHRcdFx0dmFyIHIgPSBmbigpO1xuXHRcdFx0aWYgKHIgIT09IHVuZGVmaW5lZCkgcmVzdWx0ID0gcjtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07IiwidmFyIG5leHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLng7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnggPSAoKSA9PiB7XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoMTA2KS50aGVuKG5leHQpO1xufTsiLCIvLyBUaGlzIGlzIHRoZSBlbnRyeSBwb2ludCBmb3IgYW4gSFRUUCBiYWNrZW5kIHRocmVhZFxuLy8gSXQgY2FuIHNlcnZlIG11bHRpcGxlIFNRTGl0ZSB3b3JrZXIgdGhyZWFkc1xuXG5pbXBvcnQgTFJVQ2FjaGUgZnJvbSAnbHJ1LWNhY2hlJztcbmltcG9ydCAqIGFzIFZGU0hUVFAgZnJvbSAnLi92ZnMtaHR0cC10eXBlcy5qcyc7XG5pbXBvcnQgeyBudG9oMTYgfSBmcm9tICcuL2VuZGlhbm5lc3MuanMnO1xuaW1wb3J0IHsgZGVidWcgfSBmcm9tICcuL3Zmcy1odHRwLXR5cGVzLmpzJztcblxubGV0IG9wdGlvbnM6IFZGU0hUVFAuT3B0aW9ucztcblxuLy8gVGhpcyBpZGVudGlmaWVzIGFuIFNRTGl0ZSB3b3JrZXIgdGhyZWFkXG5pbnRlcmZhY2UgQ29uc3VtZXIge1xuICBpZDogbnVtYmVyO1xuICBwb3J0OiBNZXNzYWdlUG9ydDtcbiAgc2htOiBTaGFyZWRBcnJheUJ1ZmZlcjtcbiAgbG9jazogSW50MzJBcnJheTtcbiAgYnVmZmVyOiBVaW50OEFycmF5O1xufVxuLy8gVGhlIHNldCBvZiBzcWxpdGUgV29ya2VycyB0aGF0IHVzZSB0aGlzIGJhY2tlbmRcbmNvbnN0IGNvbnN1bWVyczogUmVjb3JkPHN0cmluZywgQ29uc3VtZXI+ID0ge307XG5cbi8vIFRoZSBsaXN0IG9mIGtub3duIFVSTHMgYW5kIHJldHJpZXZlZCBwYWdlc1xuaW50ZXJmYWNlIEZpbGVFbnRyeSB7XG4gIGlkOiBudW1iZXI7XG4gIHVybDogc3RyaW5nO1xuICBzaXplOiBiaWdpbnQ7XG4gIHBhZ2VTaXplOiBudW1iZXIgfCBudWxsO1xufVxuY29uc3QgZmlsZXMgPSBuZXcgTFJVQ2FjaGU8c3RyaW5nLCBGaWxlRW50cnkgfCBQcm9taXNlPEZpbGVFbnRyeT4+KHtcbiAgbWF4OiAzMlxufSk7XG5cbi8vIFRoZSBlbnRyeSBmb3IgYSBnaXZlbiBwYWdlIGNhbiBiZSBlaXRoZXIgdGhlIHBhZ2UgaXRzZWxmXG4vLyBvciB0aGUgbnVtYmVyIG9mIHRoZSBwYWdlIHRoYXQgaGFzIHRoZSBwYXJlbnQgc3VwZXItcGFnZVxuLy8gSGVyZSBpcyBhbiBleGFtcGxlIG9mIGEgY2FjaGUgc3RydWN0dXJlIChpbmRleGVkIGJ5IHRoZSBVUkwgKyBwYWdlIG51bWJlcilcbi8vIFVSTHwwIC0+IFVpbnQ4QXJyYXkocGFnZSkgICAgICAgICAgICAgICAgICAgICAjIFRoaXMgcGFnZSBpcyBpbiBjYWNoZVxuLy8gVVJMfDEgLT4gdW5kZWZpbmVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgVGhlc2UgdHdvXG4vLyBVUkx8MiAtPiB1bmRlZmluZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBhcmUgbm90XG4vLyBVUkx8MyAtPiBQcm9taXNlPFVpbnQ4QXJyYXkocGFnZSAqIDIpPiAgICAgICAgIyBUaGlzIGlzIGEgY3VycmVudGx5IGRvd25sb2FkaW5nIDItcGFnZSBzZWdtZW50XG4vLyBVUkx8NCAtPiBQcm9taXNlPDM+ICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBUaGlzIHJlZmVyZW5jZXMgdGhlIHByZXZpb3VzIG9uZVxuLy8gVVJMfDUgLT4gMiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQW4gaW52YWxpZCBzdGFsZSBlbnRyeSB0aGF0IHdpbGwgYmUgb3ZlcndyaXR0ZW5cbmxldCBjYWNoZTogTFJVQ2FjaGU8c3RyaW5nLCBVaW50OEFycmF5IHwgbnVtYmVyIHwgUHJvbWlzZTxVaW50OEFycmF5IHwgbnVtYmVyPj47XG5cbmxldCBuZXh0SWQgPSAxO1xuXG5jb25zdCBiYWNrZW5kQXN5bmNNZXRob2RzOlxuICBSZWNvcmQ8VkZTSFRUUC5PcGVyYXRpb24sXG4gICAgKG1zZzogVkZTSFRUUC5NZXNzYWdlLCBjb25zdW1lcjogQ29uc3VtZXIpID0+IFByb21pc2U8bnVtYmVyPj4gPSB7XG4gIC8vIEhUVFAgaXMgYSBzdGF0ZWxlc3MgcHJvdG9jb2wsIHNvIHhPcGVuIG1lYW5zIHZlcmlmeSBpZiB0aGUgVVJMIGlzIHZhbGlkXG4gIHhPcGVuOiBhc3luYyBmdW5jdGlvbiAobXNnKSB7XG4gICAgbGV0IGVudHJ5ID0gZmlsZXMuZ2V0KG1zZy51cmwpO1xuICAgIGlmIChlbnRyeSBpbnN0YW5jZW9mIFByb21pc2UpXG4gICAgICBlbnRyeSA9IGF3YWl0IGVudHJ5O1xuICAgIGlmIChlbnRyeSAhPT0gdW5kZWZpbmVkKVxuICAgICAgcmV0dXJuIDA7XG5cbiAgICAvLyBTZXQgYSBwcm9taXNlIGZvciB0aGUgbmV4dCBvcGVuZXIgb2YgdGhlIHNhbWUgZmlsZSB0byBhd2FpdCB1cG9uXG4gICAgZW50cnkgPSBmZXRjaChtc2cudXJsLCB7IG1ldGhvZDogJ0hFQUQnLCBoZWFkZXJzOiB7IC4uLm9wdGlvbnM/LmhlYWRlcnMgfSB9KVxuICAgICAgLnRoZW4oKGhlYWQpID0+IHtcbiAgICAgICAgaWYgKGhlYWQuaGVhZGVycy5nZXQoJ0FjY2VwdC1SYW5nZXMnKSAhPT0gJ2J5dGVzJykge1xuICAgICAgICAgIGNvbnNvbGUud2FybihgU2VydmVyIGZvciAke21zZy51cmx9IGRvZXMgbm90IGFkdmVydGlzZSAnQWNjZXB0LVJhbmdlcycuIGAgK1xuICAgICAgICAgICAgJ0lmIHRoZSBzZXJ2ZXIgc3VwcG9ydHMgaXQsIGluIG9yZGVyIHRvIHJlbW92ZSB0aGlzIG1lc3NhZ2UsIGFkZCBcIkFjY2VwdC1SYW5nZXM6IGJ5dGVzXCIuICcgK1xuICAgICAgICAgICAgJ0FkZGl0aW9uYWxseSwgaWYgdXNpbmcgQ09SUywgYWRkIFwiQWNjZXNzLUNvbnRyb2wtRXhwb3NlLUhlYWRlcnM6ICpcIi4nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVybDogbXNnLnVybCxcbiAgICAgICAgICBpZDogbmV4dElkKyssXG4gICAgICAgICAgc2l6ZTogQmlnSW50KGhlYWQuaGVhZGVycy5nZXQoJ0NvbnRlbnQtTGVuZ3RoJykgPz8gMCksXG4gICAgICAgICAgLy8gVGhpcyB3aWxsIGJlIGRldGVybWluZWQgb24gdGhlIGZpcnN0IHJlYWRcbiAgICAgICAgICBwYWdlU2l6ZTogbnVsbFxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgZmlsZXMuc2V0KG1zZy51cmwsIGVudHJ5KTtcbiAgICAvLyBSZXBsYWNlIGl0IHdpdGggdGhlIGFjdHVhbCBlbnRyeSBvbmNlIHJlc29sdmVkXG4gICAgZmlsZXMuc2V0KG1zZy51cmwsIGF3YWl0IGVudHJ5KTtcblxuICAgIHJldHVybiAwO1xuICB9LFxuXG4gIC8vIFRoZXJlIGlzIG5vIHJlYWwgZGlmZmVyZW5jZSBiZXR3ZWVuIHhPcGVuIGFuZCB4QWNjZXNzLCBvbmx5IHRoZSBzZW1hbnRpY3MgZGlmZmVyXG4gIHhBY2Nlc3M6IGFzeW5jIGZ1bmN0aW9uIChtc2csIGNvbnN1bWVyKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IFVpbnQzMkFycmF5KGNvbnN1bWVyLnNobSwgMCwgMSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHIgPSBhd2FpdCBiYWNrZW5kQXN5bmNNZXRob2RzLnhPcGVuKG1zZywgY29uc3VtZXIpO1xuICAgICAgaWYgKHIgPT09IDApIHtcbiAgICAgICAgcmVzdWx0WzBdID0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdFswXSA9IDA7XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXN1bHRbMF0gPSAwO1xuICAgIH1cblxuICAgIHJldHVybiAwO1xuICB9LFxuXG4gIHhSZWFkOiBhc3luYyBmdW5jdGlvbiAobXNnLCBjb25zdW1lcikge1xuICAgIGxldCBlbnRyeSA9IGZpbGVzLmdldChtc2cudXJsKTtcblxuICAgIGlmICghZW50cnkpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgJHttc2cudXJsfSBub3Qgb3BlbmApO1xuICAgIGlmIChlbnRyeSBpbnN0YW5jZW9mIFByb21pc2UpXG4gICAgICBlbnRyeSA9IGF3YWl0IGVudHJ5O1xuXG4gICAgaWYgKG1zZy5uID09PSB1bmRlZmluZWQgfHwgbXNnLm9mZnNldCA9PT0gdW5kZWZpbmVkKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNYW5kYXRvcnkgYXJndW1lbnRzIG1pc3NpbmcnKTtcblxuICAgIGlmICghZW50cnkucGFnZVNpemUpIHtcbiAgICAgIC8vIERldGVybWluZSB0aGUgcGFnZSBzaXplIGlmIHdlIGRvbid0IGtub3cgaXRcbiAgICAgIC8vIEl0IGlzIGluIHR3byBiaWctZW5kaWFuIGJ5dGVzIGF0IG9mZnNldCAxNiBpbiB3aGF0IGlzIGFsd2F5cyB0aGUgZmlyc3QgcGFnZVxuICAgICAgZW50cnkucGFnZVNpemUgPSAxMDI0O1xuICAgICAgY29uc3QgcGFnZURhdGFCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMik7XG4gICAgICBjb25zdCByID0gYXdhaXQgYmFja2VuZEFzeW5jTWV0aG9kcy54UmVhZCh7IG1zZzogJ3hSZWFkJywgdXJsOiBtc2cudXJsLCBvZmZzZXQ6IEJpZ0ludCgxNiksIG46IDIgfSxcbiAgICAgICAgeyBidWZmZXI6IG5ldyBVaW50OEFycmF5KHBhZ2VEYXRhQnVmZmVyKSB9IGFzIENvbnN1bWVyKTtcbiAgICAgIGNvbnN0IHBhZ2VEYXRhID0gbmV3IFVpbnQxNkFycmF5KHBhZ2VEYXRhQnVmZmVyKTtcbiAgICAgIGlmIChyICE9PSAwKVxuICAgICAgICByZXR1cm4gcjtcbiAgICAgIG50b2gxNihwYWdlRGF0YSk7XG4gICAgICBlbnRyeS5wYWdlU2l6ZSA9IHBhZ2VEYXRhWzBdO1xuICAgICAgZGVidWdbJ3ZmcyddKGBwYWdlIHNpemUgaXMgJHtlbnRyeS5wYWdlU2l6ZX1gKTtcbiAgICAgIGlmIChlbnRyeS5wYWdlU2l6ZSAhPSAxMDI0KSB7XG4gICAgICAgIC8vIElmIHRoZSBwYWdlIHNpemUgaXMgbm90IDEwMjQgd2UgY2FuJ3Qga2VlcCB0aGlzIFwicGFnZVwiIGluIHRoZSBjYWNoZVxuICAgICAgICBjb25zb2xlLndhcm4oYFBhZ2Ugc2l6ZSBmb3IgJHttc2cudXJsfSBpcyAke2VudHJ5LnBhZ2VTaXplfSwgcmVjb21tZW5kZWQgc2l6ZSBpcyAxMDI0YCk7XG4gICAgICAgIGNhY2hlLmRlbGV0ZShlbnRyeS5pZCArICd8MCcpO1xuICAgICAgfVxuICAgICAgaWYgKGVudHJ5LnBhZ2VTaXplID4gKG9wdGlvbnM/Lm1heFBhZ2VTaXplID8/IFZGU0hUVFAuZGVmYXVsdE9wdGlvbnMubWF4UGFnZVNpemUpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZW50cnkucGFnZVNpemV9IGlzIG92ZXIgdGhlIG1heGltdW0gY29uZmlndXJlZCBgICtcbiAgICAgICAgICBgJHtvcHRpb25zPy5tYXhQYWdlU2l6ZSA/PyBWRlNIVFRQLmRlZmF1bHRPcHRpb25zLm1heFBhZ2VTaXplfWApO1xuICAgIH1cblxuICAgIGNvbnN0IHBhZ2VTaXplID0gQmlnSW50KGVudHJ5LnBhZ2VTaXplKTtcbiAgICBjb25zdCBsZW4gPSBCaWdJbnQobXNnLm4pO1xuICAgIGNvbnN0IHBhZ2UgPSBtc2cub2Zmc2V0IC8gcGFnZVNpemU7XG4gICAgaWYgKHBhZ2UgKiBwYWdlU2l6ZSAhPT0gbXNnLm9mZnNldClcbiAgICAgIGRlYnVnWyd2ZnMnXShgUmVhZCBjaHVuayAke21zZy5vZmZzZXR9OiR7bXNnLm59IGlzIG5vdCBwYWdlLWFsaWduZWRgKTtcbiAgICBsZXQgcGFnZVN0YXJ0ID0gcGFnZSAqIHBhZ2VTaXplO1xuICAgIGlmIChwYWdlU3RhcnQgKyBwYWdlU2l6ZSA8IG1zZy5vZmZzZXQgKyBsZW4pXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFJlYWQgY2h1bmsgJHttc2cub2Zmc2V0fToke21zZy5ufSBzcGFucyBhY3Jvc3MgYSBwYWdlLWJvdW5kYXJ5YCk7XG5cbiAgICBjb25zdCBjYWNoZUlkID0gZW50cnkuaWQgKyAnfCcgKyBwYWdlO1xuICAgIGxldCBkYXRhID0gY2FjaGUuZ2V0KGNhY2hlSWQpO1xuICAgIGlmIChkYXRhIGluc3RhbmNlb2YgUHJvbWlzZSlcbiAgICAgIC8vIFRoaXMgbWVhbnMgdGhhdCBhbm90aGVyIHRocmVhZCBoYXMgcmVxdWVzdGVkIHRoaXMgc2VnbWVudFxuICAgICAgZGF0YSA9IGF3YWl0IGRhdGE7XG5cbiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdudW1iZXInKSB7XG4gICAgICBkZWJ1Z1snY2FjaGUnXShgY2FjaGUgaGl0IChtdWx0aS1wYWdlIHNlZ21lbnQpIGZvciAke21zZy51cmx9OiR7cGFnZX1gKTtcblxuICAgICAgLy8gVGhpcyBwYWdlIGlzIHByZXNlbnQgYXMgYSBzZWdtZW50IG9mIGEgc3VwZXItcGFnZVxuICAgICAgY29uc3QgbmV3UGFnZVN0YXJ0ID0gQmlnSW50KGRhdGEpICogcGFnZVNpemU7XG4gICAgICBkYXRhID0gY2FjaGUuZ2V0KGVudHJ5LmlkICsgJ3wnICsgZGF0YSk7XG4gICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIFByb21pc2UpXG4gICAgICAgIGRhdGEgPSBhd2FpdCBkYXRhO1xuICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgIC8vIE5vdCBhbGwgc3VicGFnZXMgYXJlIHZhbGlkLCB0aGVyZSBhcmUgdHdvIHBvc3NpYmxlIGNhc2VzXG4gICAgICAgIC8vIHdoZXJlIGEgbm9uLXZhbGlkIHN1cGVycGFnZSBjYW4gYmUgcmVmZXJlbmNlZDpcbiAgICAgICAgLy8gKiB0aGUgc3VwZXJwYWdlIHdhcyB0b28gYmlnIHRvIGZpdCBpbiB0aGUgY2FjaGVcbiAgICAgICAgLy8gKiB0aGUgc3VwZXJwYWdlIHdhcyBldmljdGVkIGJlZm9yZSB0aGUgc3Vic2VnbWVudHNcbiAgICAgICAgcGFnZVN0YXJ0ID0gbmV3UGFnZVN0YXJ0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YSA9IHVuZGVmaW5lZCBhcyB1bmtub3duIGFzIFVpbnQ4QXJyYXk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAndW5kZWZpbmVkJykge1xuICAgICAgZGVidWdbJ2NhY2hlJ10oYGNhY2hlIG1pc3MgZm9yICR7bXNnLnVybH06JHtwYWdlfWApO1xuXG4gICAgICBsZXQgY2h1bmtTaXplID0gZW50cnkucGFnZVNpemU7XG4gICAgICAvLyBJZiB0aGUgcHJldmlvdXMgcGFnZSBpcyBpbiB0aGUgY2FjaGUsIHdlIGRvdWJsZSB0aGUgcGFnZSBzaXplXG4gICAgICAvLyBUaGlzIHdhcyB0aGUgb3JpZ2luYWwgcGFnZSBtZXJnaW5nIGFsZ29yaXRobSBpbXBsZW1lbnRlZCBieSBAcGhpcmVza3lcbiAgICAgIGxldCBwcmV2ID0gcGFnZSA+IDAgJiYgY2FjaGUuZ2V0KGVudHJ5LmlkICsgJ3wnICsgKE51bWJlcihwYWdlKSAtIDEpKTtcbiAgICAgIGlmIChwcmV2KSB7XG4gICAgICAgIGlmIChwcmV2IGluc3RhbmNlb2YgUHJvbWlzZSlcbiAgICAgICAgICBwcmV2ID0gYXdhaXQgcHJldjtcbiAgICAgICAgaWYgKHR5cGVvZiBwcmV2ID09PSAnbnVtYmVyJylcbiAgICAgICAgICBwcmV2ID0gY2FjaGUuZ2V0KGVudHJ5LmlkICsgJ3wnICsgcHJldikgYXMgVWludDhBcnJheTtcbiAgICAgICAgaWYgKHByZXYgaW5zdGFuY2VvZiBQcm9taXNlKVxuICAgICAgICAgIHByZXYgPSBhd2FpdCBwcmV2O1xuICAgICAgICBpZiAocHJldiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICAgICAgICAvLyBWYWxpZCBzdXBlcnBhZ2VcbiAgICAgICAgICBjaHVua1NpemUgPSBwcmV2LmJ5dGVMZW5ndGggKiAyO1xuICAgICAgICAgIGRlYnVnWydjYWNoZSddKGBkb3dubG9hZGluZyBzdXBlciBwYWdlIG9mIHNpemUgJHtjaHVua1NpemV9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHBhZ2VzID0gY2h1bmtTaXplIC8gZW50cnkucGFnZVNpemU7XG5cbiAgICAgIC8vIERvd25sb2FkIGEgbmV3IHNlZ21lbnRcbiAgICAgIGRlYnVnWydodHRwJ10oYGRvd25sb2FkaW5nIHBhZ2UgJHtwYWdlfSBvZiBzaXplICR7Y2h1bmtTaXplfSBzdGFydGluZyBhdCAke3BhZ2VTdGFydH1gKTtcbiAgICAgIGNvbnN0IHJlc3AgPSBmZXRjaChtc2cudXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAuLi4ob3B0aW9ucz8uaGVhZGVycyA/PyBWRlNIVFRQLmRlZmF1bHRPcHRpb25zLmhlYWRlcnMpLFxuICAgICAgICAgICdSYW5nZSc6IGBieXRlcz0ke3BhZ2VTdGFydH0tJHtwYWdlU3RhcnQgKyBCaWdJbnQoY2h1bmtTaXplIC0gMSl9YFxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgICAudGhlbigocikgPT4gci5hcnJheUJ1ZmZlcigpKVxuICAgICAgICAudGhlbigocikgPT4gbmV3IFVpbnQ4QXJyYXkocikpO1xuICAgICAgLy8gV2Ugc3luY2hyb25vdXNseSBzZXQgYSBQcm9taXNlIGluIHRoZSBjYWNoZSBpbiBjYXNlIGFub3RoZXIgdGhyZWFkXG4gICAgICAvLyB0cmllcyB0byByZWFkIHRoZSBzYW1lIHNlZ21lbnRcbiAgICAgIGNhY2hlLnNldChjYWNoZUlkLCByZXNwKTtcbiAgICAgIC8vIFRoZXNlIHBvaW50IHRvIHRoZSBwYXJlbnQgc3VwZXItcGFnZSBhbmQgcmVzb2x2ZSBhdCB0aGUgc2FtZSB0aW1lIGFzIHJlc3BcbiAgICAgIGZvciAobGV0IGkgPSBOdW1iZXIocGFnZSkgKyAxOyBpIDwgTnVtYmVyKHBhZ2UpICsgcGFnZXM7IGkrKykge1xuICAgICAgICBjYWNoZS5zZXQoZW50cnkuaWQgKyAnfCcgKyBpLCByZXNwLnRoZW4oKCkgPT4gTnVtYmVyKHBhZ2UpKSk7XG4gICAgICB9XG5cbiAgICAgIGRhdGEgPSBhd2FpdCByZXNwO1xuICAgICAgaWYgKCEoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHx8IGRhdGEubGVuZ3RoID09PSAwKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgSFRUUCByZXNwb25zZSByZWNlaXZlZDogJHtKU09OLnN0cmluZ2lmeShyZXNwKX1gKTtcblxuICAgICAgLy8gSW4gY2FzZSBvZiBhIG11bHRpcGxlLXBhZ2Ugc2VnbWVudCwgdGhpcyBpcyB0aGUgcGFyZW50IHN1cGVyLXBhZ2VcbiAgICAgIGNhY2hlLnNldChjYWNoZUlkLCBkYXRhKTtcblxuICAgICAgLy8gVGhlc2UgcG9pbnQgdG8gdGhlIHBhcmVudCBzdXBlci1wYWdlXG4gICAgICBmb3IgKGxldCBpID0gTnVtYmVyKHBhZ2UpICsgMTsgaSA8IE51bWJlcihwYWdlKSArIHBhZ2VzOyBpKyspIHtcbiAgICAgICAgY2FjaGUuc2V0KGVudHJ5LmlkICsgJ3wnICsgaSwgTnVtYmVyKHBhZ2UpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZGVidWdbJ2NhY2hlJ10oYGNhY2hlIGhpdCBmb3IgJHttc2cudXJsfToke3BhZ2V9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgcGFnZU9mZnNldCA9IE51bWJlcihtc2cub2Zmc2V0IC0gcGFnZVN0YXJ0KTtcbiAgICBjb25zdW1lci5idWZmZXIuc2V0KGRhdGEuc3ViYXJyYXkocGFnZU9mZnNldCwgcGFnZU9mZnNldCArIG1zZy5uKSk7XG4gICAgcmV0dXJuIDA7XG4gIH0sXG5cbiAgLy8gVGhpcyBpcyBjYWNoZWRcbiAgeEZpbGVzaXplOiBhc3luYyBmdW5jdGlvbiAobXNnLCBjb25zdW1lcikge1xuICAgIGxldCBlbnRyeSA9IGZpbGVzLmdldChtc2cudXJsKTtcbiAgICBpZiAoIWVudHJ5KVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlICR7bXNnLmZpZH0gbm90IG9wZW5gKTtcbiAgICBpZiAoZW50cnkgaW5zdGFuY2VvZiBQcm9taXNlKVxuICAgICAgZW50cnkgPSBhd2FpdCBlbnRyeTtcblxuICAgIGNvbnN0IG91dCA9IG5ldyBCaWdJbnQ2NEFycmF5KGNvbnN1bWVyLnNobSwgMCwgMSk7XG4gICAgb3V0WzBdID0gZW50cnkuc2l6ZTtcbiAgICByZXR1cm4gMDtcbiAgfVxufTtcblxuYXN5bmMgZnVuY3Rpb24gd29ya01lc3NhZ2UodGhpczogQ29uc3VtZXIsIHsgZGF0YSB9OiB7IGRhdGE6IFZGU0hUVFAuTWVzc2FnZSB9KSB7XG4gIGRlYnVnWyd0aHJlYWRzJ10oJ1JlY2VpdmVkIG5ldyB3b3JrIG1lc3NhZ2UnLCB0aGlzLCBkYXRhKTtcbiAgbGV0IHI7XG4gIHRyeSB7XG4gICAgciA9IGF3YWl0IGJhY2tlbmRBc3luY01ldGhvZHNbZGF0YS5tc2ddKGRhdGEsIHRoaXMpO1xuXG4gICAgZGVidWdbJ3RocmVhZHMnXSgnb3BlcmF0aW9uIHN1Y2Nlc3NmdWwnLCB0aGlzLCByKTtcbiAgICBBdG9taWNzLnN0b3JlKHRoaXMubG9jaywgMCwgcik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgIEF0b21pY3Muc3RvcmUodGhpcy5sb2NrLCAwLCAxKTtcbiAgfVxuICBBdG9taWNzLm5vdGlmeSh0aGlzLmxvY2ssIDApO1xufVxuXG5nbG9iYWxUaGlzLm9ubWVzc2FnZSA9ICh7IGRhdGEgfSkgPT4ge1xuICBkZWJ1Z1sndGhyZWFkcyddKCdSZWNlaXZlZCBuZXcgY29udHJvbCBtZXNzYWdlJywgZGF0YSk7XG4gIHN3aXRjaCAoZGF0YS5tc2cpIHtcbiAgICBjYXNlICdoYW5kc2hha2UnOlxuICAgICAge1xuICAgICAgICBjb25zdCBzaG0gPSBuZXcgU2hhcmVkQXJyYXlCdWZmZXIoKG9wdGlvbnM/Lm1heFBhZ2VTaXplID8/IFZGU0hUVFAuZGVmYXVsdE9wdGlvbnMubWF4UGFnZVNpemUpXG4gICAgICAgICAgKyBJbnQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UKTtcbiAgICAgICAgY29uc3QgbG9jayA9IG5ldyBJbnQzMkFycmF5KHNobSwgKG9wdGlvbnM/Lm1heFBhZ2VTaXplID8/IFZGU0hUVFAuZGVmYXVsdE9wdGlvbnMubWF4UGFnZVNpemUpKTtcbiAgICAgICAgY29uc3QgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoc2htLCAwLCAob3B0aW9ucz8ubWF4UGFnZVNpemUgPz8gVkZTSFRUUC5kZWZhdWx0T3B0aW9ucy5tYXhQYWdlU2l6ZSkpO1xuICAgICAgICBsb2NrWzBdID0gMHhmZmZmO1xuICAgICAgICBjb25zdW1lcnNbZGF0YS5pZF0gPSB7IGlkOiBkYXRhLmlkLCBwb3J0OiBkYXRhLnBvcnQsIHNobSwgbG9jaywgYnVmZmVyIH07XG4gICAgICAgIHBvc3RNZXNzYWdlKHsgbXNnOiAnYWNrJywgaWQ6IGRhdGEuaWQsIHNobSwgbG9jayB9KTtcbiAgICAgICAgZGF0YS5wb3J0Lm9ubWVzc2FnZSA9IHdvcmtNZXNzYWdlLmJpbmQoY29uc3VtZXJzW2RhdGEuaWRdKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2luaXQnOlxuICAgICAgb3B0aW9ucyA9IGRhdGEub3B0aW9ucztcbiAgICAgIGNhY2hlID0gbmV3IExSVUNhY2hlKHtcbiAgICAgICAgbWF4U2l6ZTogKG9wdGlvbnM/LmNhY2hlU2l6ZSA/PyBWRlNIVFRQLmRlZmF1bHRPcHRpb25zLmNhY2hlU2l6ZSkgKiAxMDI0LFxuICAgICAgICBzaXplQ2FsY3VsYXRpb246ICh2YWx1ZSkgPT4gKHZhbHVlIGFzIFVpbnQ4QXJyYXkpLmJ5dGVMZW5ndGggPz8gNFxuICAgICAgfSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdjbG9zZSc6XG4gICAgICBwb3N0TWVzc2FnZSh7IG1zZzogJ2FjaycgfSk7XG4gICAgICBjbG9zZSgpO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBtZXNzYWdlIHJlY2VpdmVkIGJ5IGJhY2tlbmQ6ICR7ZGF0YX1gKTtcbiAgfVxufTtcblxuaWYgKHR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdTaGFyZWRBcnJheUJ1ZmZlciBpcyBub3QgYXZhaWxhYmxlLiAnICtcbiAgICAnSWYgeW91ciBicm93c2VyIHN1cHBvcnRzIGl0LCB0aGUgd2Vic2VydmVyIG11c3Qgc2VuZCAnICtcbiAgICAnXCJDcm9zcy1PcmlnaW4tT3BlbmVyLVBvbGljeTogc2FtZS1vcmlnaW4gXCInICtcbiAgICAnYW5kIFwiQ3Jvc3MtT3JpZ2luLUVtYmVkZGVyLVBvbGljeTogcmVxdWlyZS1jb3JwXCIgaGVhZGVycy4nKTtcbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuLy8gdGhlIHN0YXJ0dXAgZnVuY3Rpb25cbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5cdC8vIFRoaXMgZW50cnkgbW9kdWxlIGRlcGVuZHMgb24gb3RoZXIgbG9hZGVkIGNodW5rcyBhbmQgZXhlY3V0aW9uIG5lZWQgdG8gYmUgZGVsYXllZFxuXHR2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFsxMDZdLCAoKSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXygxMzk5KSkpXG5cdF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG5cdHJldHVybiBfX3dlYnBhY2tfZXhwb3J0c19fO1xufTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IChjaHVua0lkKSA9PiB7XG5cdHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZSgocHJvbWlzZXMsIGtleSkgPT4ge1xuXHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdH0sIFtdKSk7XG59OyIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFzeW5jIGNodW5rcyBhbmQgc2libGluZyBjaHVua3MgZm9yIHRoZSBlbnRyeXBvaW50XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnUgPSAoY2h1bmtJZCkgPT4ge1xuXHQvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcblx0cmV0dXJuIFwiXCIgKyBjaHVua0lkICsgXCIuYnVuZGxlLmpzXCI7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsInZhciBzY3JpcHRVcmw7XG5pZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5nLmltcG9ydFNjcmlwdHMpIHNjcmlwdFVybCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5sb2NhdGlvbiArIFwiXCI7XG52YXIgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcuZG9jdW1lbnQ7XG5pZiAoIXNjcmlwdFVybCAmJiBkb2N1bWVudCkge1xuXHRpZiAoZG9jdW1lbnQuY3VycmVudFNjcmlwdClcblx0XHRzY3JpcHRVcmwgPSBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYztcblx0aWYgKCFzY3JpcHRVcmwpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGlmKHNjcmlwdHMubGVuZ3RoKSBzY3JpcHRVcmwgPSBzY3JpcHRzW3NjcmlwdHMubGVuZ3RoIC0gMV0uc3JjXG5cdH1cbn1cbi8vIFdoZW4gc3VwcG9ydGluZyBicm93c2VycyB3aGVyZSBhbiBhdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIHlvdSBtdXN0IHNwZWNpZnkgYW4gb3V0cHV0LnB1YmxpY1BhdGggbWFudWFsbHkgdmlhIGNvbmZpZ3VyYXRpb25cbi8vIG9yIHBhc3MgYW4gZW1wdHkgc3RyaW5nIChcIlwiKSBhbmQgc2V0IHRoZSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyB2YXJpYWJsZSBmcm9tIHlvdXIgY29kZSB0byB1c2UgeW91ciBvd24gbG9naWMuXG5pZiAoIXNjcmlwdFVybCkgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXJcIik7XG5zY3JpcHRVcmwgPSBzY3JpcHRVcmwucmVwbGFjZSgvIy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcPy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgXCIvXCIpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2NyaXB0VXJsOyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBjaHVua3Ncbi8vIFwiMVwiIG1lYW5zIFwiYWxyZWFkeSBsb2FkZWRcIlxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0Mzk5OiAxXG59O1xuXG4vLyBpbXBvcnRTY3JpcHRzIGNodW5rIGxvYWRpbmdcbnZhciBpbnN0YWxsQ2h1bmsgPSAoZGF0YSkgPT4ge1xuXHR2YXIgW2NodW5rSWRzLCBtb3JlTW9kdWxlcywgcnVudGltZV0gPSBkYXRhO1xuXHRmb3IodmFyIG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0fVxuXHR9XG5cdGlmKHJ1bnRpbWUpIHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdHdoaWxlKGNodW5rSWRzLmxlbmd0aClcblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZHMucG9wKCldID0gMTtcblx0cGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG59O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmkgPSAoY2h1bmtJZCwgcHJvbWlzZXMpID0+IHtcblx0Ly8gXCIxXCIgaXMgdGhlIHNpZ25hbCBmb3IgXCJhbHJlYWR5IGxvYWRlZFwiXG5cdGlmKCFpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRpZih0cnVlKSB7IC8vIGFsbCBjaHVua3MgaGF2ZSBKU1xuXHRcdFx0aW1wb3J0U2NyaXB0cyhfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCkpO1xuXHRcdH1cblx0fVxufTtcblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtvbF9ncGtnXCJdID0gc2VsZltcIndlYnBhY2tDaHVua29sX2dwa2dcIl0gfHwgW107XG52YXIgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24gPSBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IGluc3RhbGxDaHVuaztcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdCIsIi8vIHJ1biBzdGFydHVwXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18ueCgpO1xuIl0sIm5hbWVzIjpbImRlZmVycmVkIiwibmV4dCIsIm9wdGlvbnMiLCJjb25zdW1lcnMiLCJmaWxlcyIsIm1heCIsImNhY2hlIiwibmV4dElkIiwiYmFja2VuZEFzeW5jTWV0aG9kcyIsInhPcGVuIiwibXNnIiwiZW50cnkiLCJnZXQiLCJ1cmwiLCJQcm9taXNlIiwidW5kZWZpbmVkIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwidGhlbiIsImhlYWQiLCJjb25zb2xlIiwid2FybiIsImlkIiwic2l6ZSIsIkJpZ0ludCIsInBhZ2VTaXplIiwic2V0IiwieEFjY2VzcyIsImNvbnN1bWVyIiwicmVzdWx0IiwiVWludDMyQXJyYXkiLCJzaG0iLCJyIiwieFJlYWQiLCJFcnJvciIsIm4iLCJvZmZzZXQiLCJwYWdlRGF0YUJ1ZmZlciIsIkFycmF5QnVmZmVyIiwiYnVmZmVyIiwiVWludDhBcnJheSIsInBhZ2VEYXRhIiwiVWludDE2QXJyYXkiLCJkZWxldGUiLCJtYXhQYWdlU2l6ZSIsImxlbiIsInBhZ2UiLCJwYWdlU3RhcnQiLCJjYWNoZUlkIiwiZGF0YSIsIm5ld1BhZ2VTdGFydCIsImNodW5rU2l6ZSIsInByZXYiLCJOdW1iZXIiLCJieXRlTGVuZ3RoIiwicGFnZXMiLCJyZXNwIiwiYXJyYXlCdWZmZXIiLCJpIiwibGVuZ3RoIiwiSlNPTiIsInN0cmluZ2lmeSIsInBhZ2VPZmZzZXQiLCJzdWJhcnJheSIsInhGaWxlc2l6ZSIsImZpZCIsIkJpZ0ludDY0QXJyYXkiLCJ3b3JrTWVzc2FnZSIsInRoaXMiLCJBdG9taWNzIiwic3RvcmUiLCJsb2NrIiwiZSIsImVycm9yIiwibm90aWZ5IiwiZ2xvYmFsVGhpcyIsIm9ubWVzc2FnZSIsIlNoYXJlZEFycmF5QnVmZmVyIiwiSW50MzJBcnJheSIsIkJZVEVTX1BFUl9FTEVNRU5UIiwicG9ydCIsInBvc3RNZXNzYWdlIiwiYmluZCIsIm1heFNpemUiLCJjYWNoZVNpemUiLCJzaXplQ2FsY3VsYXRpb24iLCJ2YWx1ZSIsImNsb3NlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJtIiwieCIsIl9fd2VicGFja19leHBvcnRzX18iLCJPIiwiY2h1bmtJZHMiLCJmbiIsInByaW9yaXR5Iiwibm90RnVsZmlsbGVkIiwiSW5maW5pdHkiLCJmdWxmaWxsZWQiLCJqIiwiT2JqZWN0Iiwia2V5cyIsImV2ZXJ5Iiwia2V5Iiwic3BsaWNlIiwiZCIsImRlZmluaXRpb24iLCJvIiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZiIsImNodW5rSWQiLCJhbGwiLCJyZWR1Y2UiLCJwcm9taXNlcyIsInUiLCJnIiwiRnVuY3Rpb24iLCJ3aW5kb3ciLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwic2NyaXB0VXJsIiwiaW1wb3J0U2NyaXB0cyIsImxvY2F0aW9uIiwiZG9jdW1lbnQiLCJjdXJyZW50U2NyaXB0Iiwic3JjIiwic2NyaXB0cyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicmVwbGFjZSIsInAiLCJpbnN0YWxsZWRDaHVua3MiLCJjaHVua0xvYWRpbmdHbG9iYWwiLCJzZWxmIiwicGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24iLCJwdXNoIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwicG9wIl0sInNvdXJjZVJvb3QiOiIifQ==